â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                       â•‘
â•‘         DRIVERS HEALTH - NEW FRONT DOOR DEPLOYMENT                   â•‘
â•‘         Pyx Health - Drivers Health Service                          â•‘
â•‘                                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


âœ… CONFIRMED: THIS IS A NEW FRONT DOOR FOR DRIVERS HEALTH!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NOT the existing fdp-prod Front Door!

This creates a SEPARATE Front Door specifically for Drivers Health with:
- DH (Drivers Health) naming convention
- Separate subscription: "Drivers Health"
- Separate resource group: "rg-drivershealth-prod"
- New Front Door name: "fdh-prod" (Front Door Health)


ðŸŽ¯ DRIVERS HEALTH NAMING CONVENTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ALL resources use "DH" or "DriversHealth" prefix:

âœ… Front Door: fdh-prod (NOT fdp-prod)
âœ… Endpoint: afd-drivershealth-prod (NOT afd-identity-prod)
âœ… Origin Group: dh-origin-group (NOT prod-origin-group)
âœ… WAF Policy: drivershealthprodwafpolicy (NOT identityprodfwafpolicy)
âœ… Log Workspace: law-fdh-prod (NOT law-fdp-prod)
âœ… Alerts: DH-High-Latency-Alert (NOT High-Latency-Alert)
âœ… Resource Group: rg-drivershealth-prod (NOT Production)

THIS IS COMPLETELY SEPARATE FROM EXISTING FRONT DOORS!


ðŸš€ QUICK START
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Prerequisites
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

PowerShell as Administrator:

    Install-Module -Name Az.Accounts, Az.FrontDoor, Az.Resources -Force

Azure CLI:
    Download: https://aka.ms/installazurecliwindows


STEP 2: Run Deployment
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    .\Deploy-DriversHealth-FrontDoor.ps1

The script will:
âœ… Find "Drivers Health" subscription automatically
âœ… Create NEW resource group "rg-drivershealth-prod"
âœ… Search for Drivers Health backend services
âœ… Create NEW Front Door "fdh-prod"
âœ… Configure with DH naming convention
âœ… Deploy everything (10-15 minutes)


STEP 3: Verify
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Azure Portal:
    Search for "fdh-prod"

PowerShell:
    Get-AzFrontDoor -ResourceGroupName "rg-drivershealth-prod" -Name "fdh-prod"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ“¦ WHAT GETS CREATED (ALL NEW!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Resource Group:
  â””â”€ rg-drivershealth-prod (NEW!)

Front Door Premium:
  â””â”€ fdh-prod (NEW!)
       â”œâ”€ Endpoint: afd-drivershealth-prod
       â”œâ”€ Origin Group: dh-origin-group
       â”œâ”€ Origins: Auto-detected Drivers Health backends
       â””â”€ Routes: route-drivershealth-prod

Security:
  â”œâ”€ WAF Policy: drivershealthprodwafpolicy (NEW!)
  â”‚    â”œâ”€ Microsoft Default RS 2.1
  â”‚    â””â”€ Bot Protection 1.0
  â””â”€ Managed Identity: System-assigned

Monitoring:
  â”œâ”€ Log Analytics: law-fdh-prod (NEW!)
  â”œâ”€ Diagnostic Settings: 90 days retention
  â””â”€ Alerts:
       â”œâ”€ DH-High-Latency-Alert
       â”œâ”€ DH-High-Error-Rate-Alert
       â””â”€ DH-Origin-Health-Alert

Tags:
  â”œâ”€ Service: Drivers Health
  â”œâ”€ Company: Pyx Health
  â”œâ”€ Environment: prod
  â”œâ”€ CostCenter: Drivers-Health
  â””â”€ Purpose: Drivers Health Platform


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ” AUTO-DETECTION FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The script AUTOMATICALLY finds:

âœ… Drivers Health subscription
   â†’ Searches for "Drivers Health", "DriversHealth", "DH"
   â†’ Shows all subscriptions if not found
   â†’ Lets you choose manually

âœ… Drivers Health backend services
   â†’ Searches for App Services with "drivershealth", "drivers-health"
   â†’ Auto-configures origins
   â†’ Lets you specify manually if not found

âœ… Correct resource group
   â†’ Creates "rg-drivershealth-prod" if not exists
   â†’ Updates tags if exists


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


âš™ï¸ CUSTOMIZATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Default values (all using DH convention):

    Front Door Name: fdh-prod
    Resource Group: rg-drivershealth-prod
    Subscription: Auto-detected "Drivers Health"
    Endpoint: afd-drivershealth-prod
    Origin Group: dh-origin-group
    WAF Policy: drivershealthprodwafpolicy

To override:

    .\Deploy-DriversHealth-FrontDoor.ps1 `
        -SubscriptionName "YourDriversHealthSub" `
        -ResourceGroupName "rg-dh-custom" `
        -FrontDoorName "fdh-custom" `
        -Environment "prod"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ”’ SECURITY CONFIGURATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WAF Policy: drivershealthprodwafpolicy
  â”œâ”€ Mode: Prevention (blocks threats)
  â”œâ”€ Default Rule Set 2.1 (OWASP top 10)
  â””â”€ Bot Manager 1.0 (bot protection)

Managed Identity:
  â””â”€ System-assigned (no credentials needed)

HTTPS:
  â”œâ”€ Automatic redirect (HTTP â†’ HTTPS)
  â”œâ”€ TLS 1.2 minimum
  â””â”€ Strong cipher suites

Health Probes:
  â”œâ”€ Path: /health
  â”œâ”€ Interval: Every 30 seconds
  â”œâ”€ Protocol: HTTPS only
  â””â”€ Method: GET


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ“Š MONITORING & ALERTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Log Analytics Workspace:
  â””â”€ law-fdh-prod (NEW workspace for Drivers Health)

Diagnostic Logs (90 days):
  â”œâ”€ Access logs
  â”œâ”€ Health probe logs
  â””â”€ WAF logs

Metric Alerts:
  â”œâ”€ DH-High-Latency-Alert (>1000ms)
  â”œâ”€ DH-High-Error-Rate-Alert (>100 errors/5min)
  â””â”€ DH-Origin-Health-Alert (<50% healthy)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


âœ… VERIFICATION STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After deployment:

1. Check Front Door exists:
   Get-AzFrontDoor -ResourceGroupName "rg-drivershealth-prod" -Name "fdh-prod"

2. Check WAF Policy:
   Get-AzFrontDoorWafPolicy -ResourceGroupName "rg-drivershealth-prod" -Name "drivershealthprodwafpolicy"

3. Test endpoint:
   curl -I https://afd-drivershealth-prod-XXXXXXXXXX.azurefd.net

4. View in Azure Portal:
   https://portal.azure.com â†’ Search "fdh-prod"

5. Check logs:
   Azure Monitor â†’ Log Analytics â†’ law-fdh-prod


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


âŒ TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Issue: "Drivers Health subscription not found"
Fix: Script will show all subscriptions, choose the correct one

Issue: "No backend services found"
Fix: Script will ask for manual hostname, enter Drivers Health backend

Issue: "Resource group already exists"
Fix: Script will use existing and update tags (safe)

Issue: "Front Door name already in use"
Fix: Choose different name with -FrontDoorName parameter

Issue: "Azure CLI not installed"
Fix: Install from https://aka.ms/installazurecliwindows


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ“ IMPORTANT NOTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… This creates a BRAND NEW Front Door
âœ… Uses SEPARATE subscription (Drivers Health)
âœ… Uses SEPARATE resource group
âœ… Uses DH naming convention throughout
âœ… Does NOT affect existing fdp-prod Front Door
âœ… Completely independent deployment
âœ… All resources tagged with "Service: Drivers Health"

THIS IS NOT THE SAME AS fdp-prod!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸŽ‰ AFTER DEPLOYMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

You'll have:

âœ… New Front Door: fdh-prod
âœ… New Endpoint for Drivers Health
âœ… New WAF Policy with security rules
âœ… New Origins pointing to Drivers Health backends
âœ… New Monitoring with Log Analytics
âœ… New Alerts for Drivers Health
âœ… Complete deployment report

All separate from existing Front Doors!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ðŸ“„ FILES INCLUDED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Deploy-DriversHealth-FrontDoor.ps1
  â†’ Main deployment script (RUN THIS!)

DRIVERS-HEALTH-START-HERE.txt
  â†’ This file (quick reference)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


Â© 2025 Pyx Health - Drivers Health Service
Infrastructure Automation by Syed Rizvi
